<div class="" *ngIf="!isGameInProgress">
  <button class="button is-primary is-pulled-right" (click)="displayAddGangerDialog()">Add Ganger</button>
</div>
<div *ngIf="gangers.length == 0">You don't have any gangers in your gang yet. Add them above.</div>

<table class="table is-striped is-fullwidth" *ngIf="gangers.length > 0">
  <thead>
    <tr>
      <th *ngIf="!isGameInProgress"></th>
      <th>Name</th>
      <th>M</th>
      <th>WS</th>
      <th>BS</th>
      <th>S</th>
      <th>T</th>
      <th>W</th>
      <th>I</th>
      <th>A</th>
      <th>Ld</th>
      <th>Equipment</th>
      <th>Skills</th>
      <th>Injuries</th>
      <th>Cost</th>
      <th>Exp.</th>
      <th *ngIf="isGameInProgress">Fleshwound</th>
      <th *ngIf="isGameInProgress">Kills</th>
      <th *ngIf="isGameInProgress">Objectives</th>
      <th *ngIf="isGameInProgress">Down</th>
      <th *ngIf="isGameInProgress">Out of Action</th>
    </tr>
  </thead>
  <tr 
    *ngFor="let ganger of gangers; let i = index" 
    [attr.data-index]="i" 
    [hidden]="!ganger.isEnabled && isGameInProgress" 
    [ngClass]="{'hasFleshWound': ganger.hasFleshWound }"
  >
    <td *ngIf="!isGameInProgress">
      <input type="checkbox" checked="checked" (change)="ganger.isEnabled = !ganger.isEnabled" />
    </td>
    <td>
      <div><strong>{{ganger.name}}</strong></div>
      <div class="is-small">{{ganger.gangerType}}</div>
    </td>
    <td>{{ganger.move}}</td>
    <td>{{ganger.weaponSkill}}</td>
    <td>{{ganger.ballisticSkill}}</td>
    <td>{{ganger.strength}}</td>
    <td>{{ganger.toughness}}</td>
    <td>{{ganger.wounds}}</td>
    <td>{{ganger.initiative}}</td>
    <td>{{ganger.attack}}</td>
    <td>{{ganger.leadership}}</td>
    <td>{{parseGangerEquipment(ganger)}}</td>
    <td></td>
    <td></td>
    <td>{{ganger.cost}}</td>
    <td>{{ganger.experience}}</td>
    <td *ngIf="isGameInProgress">
        <input type="checkbox" (click)="toggleFleshwound(ganger)" />
    </td>
    <td *ngIf="isGameInProgress">
      <input type="number" class="input is-small" [formControl]="gangerBattleReportForm.controls['gangerReports'].controls[i].controls['kills']"/>
    </td>
    <td *ngIf="isGameInProgress">
      <input type="number" class="input is-small" [formControl]="gangerBattleReportForm.controls['gangerReports'].controls[i].controls['objectives']"/>
    </td>
    <td *ngIf="isGameInProgress">
      <input type="checkbox" [formControl]="gangerBattleReportForm.controls['gangerReports'].controls[i].controls['down']"/>
    </td>
    <td *ngIf="isGameInProgress">
      <input type="checkbox" [formControl]="gangerBattleReportForm.controls['gangerReports'].controls[i].controls['outOfAction']" />
    </td>    
  </tr>
</table>

<div>
  <button 
    class="button is-primary is-pulled-right"
    *ngIf="isGameInProgress"
    (click)="displayFinishGameDialog()"
  >
    Finish game
  </button>
</div>

<div class="modal" *ngIf="showAddGangerDialog" [ngClass]="{'is-active': showAddGangerDialog}">
  <div class="modal-background" (click)="showAddGangerDialog = false;"></div>
  <div class="modal-content">
      <div class="modal-card">
          <header class="modal-card-head">
              <h3 class="title">Login to Hivemind</h3>
          </header>
          <section class="modal-card-body">
              <form [formGroup]="addGangerForm" (ngSubmit)="submitAddGangerForm()">
                  <div>
                      <div class="field">
                          <label class="label">Ganger Name</label>
                          <div class="control">
                              <input class="input" type="text" [formControl]="addGangerForm.controls['gangerName']">
                          </div>
                      </div>
                      <div class="field">
                          <label class="label">Ganger Type</label>
                          <div class="select">
                            <select [formControl]="addGangerForm.controls['gangerType']" (change)="checkAddGangerType()">
                              <option value="JUVE">Juve - ¢25</option>
                              <option value="GANGER">Ganger - ¢50</option>
                              <option value="HEAVY">Heavy - ¢60</option>
                              <option value="LEADER">Leader - ¢120</option>
                            </select>
                          </div>
                      </div>
                      <button type="submit" class="button is-primary" [ngClass]="{'is-loading': isLoginLoading}">Submit</button>
                  </div>
              </form>
          </section>
      </div>
  </div>
  <button class="modal-close is-large" aria-label="close" (click)="showAddGangerDialog = false;"></button>
</div>

<div class="modal" *ngIf="showFinishGameDialog" [ngClass]="{'is-active': showFinishGameDialog}">
  <div class="modal-background" (click)="showFinishGameDialog = false;"></div>
  <div class="modal-content">
      <div class="modal-card">
          <header class="modal-card-head">
              <h3 class="title">Finish game</h3>
          </header>
          <section class="modal-card-body">
              <form [formGroup]="finishGameForm" (ngSubmit)="finishGame()">
                  <div>
                      <div class="field">
                          <label class="label">Game won?</label>
                          <div class="control">
                            <label class="radio">
                              <input type="radio" name="hasWon" value="true" [formControl]="finishGameForm.controls['hasWon']" />
                              Yes
                            </label>
                            <label class="radio">
                              <input type="radio" name="hasWon" value="false" [formControl]="finishGameForm.controls['hasWon']" />
                              No
                            </label>
                          </div>
                      </div>
                      <div class="field">
                        <label class="label">Was attacker?</label>
                        <div class="control">
                          <label class="radio">
                            <input type="radio" name="isAttacker" value="true" [formControl]="finishGameForm.controls['isAttacker']" />
                            Yes
                          </label>
                          <label class="radio">
                            <input class="radio" type="radio" name="isAttacker" value="false" [formControl]="finishGameForm.controls['isAttacker']" />
                            No                              
                          </label>
                        </div>
                      </div>
                      <div class="field">
                        <label class="label">Opponent gang rating</label>
                        <div class="control">
                            <input class="input" type="number" value="true" [formControl]="finishGameForm.controls['opponentGangRating']">
                        </div>
                      </div>
                      <div class="field">
                          <label class="label">Game Type</label>
                          <div class="select">
                            <select [formControl]="finishGameForm.controls['gameType']">
                              <option value="GANG_FIGHT" selected>lbl_gametype_gang_fight</option>
                              <option value="SCAVENGERS">lbl_gametype_scavengers</option>
                              <option value="HIT_AND_RUN">lbl_gametype_hit_and_run</option>
                              <option value="AMBUSH">lbl_gametype_ambush</option>
                              <option value="THE_RAID">lbl_gametype_the_raid</option>
                              <option value="RESCUE_MISSION">lbl_gametype_rescue_mission</option>
                              <option value="SHOOT_OUT">lbl_gametype_shoot_out</option>
                            </select>
                          </div>
                      </div>
                      <button type="submit" class="button is-primary" [ngClass]="{'is-loading': isLoginLoading}">Submit</button>
                  </div>
              </form>
          </section>
      </div>
  </div>
  <button class="modal-close is-large" aria-label="close" (click)="showAddGangerDialog = false;"></button>
</div>